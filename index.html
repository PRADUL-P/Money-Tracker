<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LUDARP Money Tracker</title>
  <meta name="theme-color" content="#2563eb" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- AUTH -->
  <div id="authScreen" class="auth-screen">
    <div class="auth-card">
      <h2 id="authTitle">Welcome</h2>
      <p id="authSubtitle" class="subtitle"></p>

      <form id="authForm" class="auth-form">
        <div id="authNameRow">
          <label for="authName">Your name</label>
          <input id="authName" type="text" placeholder="Name" />
        </div>

        <label for="authPassword">App password</label>
        <input id="authPassword" type="password" placeholder="Set / Enter password" />

        <div class="auth-row">
          <button id="authSubmitBtn" class="btn-primary" type="submit">Continue</button>
          <button id="forgotBtn" class="btn-secondary" type="button">Forgot?</button>
        </div>

        <div id="authHint" class="info"></div>
      </form>
    </div>
  </div>

  <!-- APP -->
  <div id="appRoot" class="appRoot" style="display:none;">
    <header class="app-header card">
      <div class="header-top">
        <div>
          <h1>LUDARP Money Tracker</h1>
          <p class="subtitle">Offline daily tracker â€” secure on your device</p>
        </div>

        <div class="header-actions">
          <!-- quick theme toggle (kept for convenience) -->
          <button id="themeToggleTop" class="icon-button" title="Toggle theme quick">ðŸŒ™</button>
          <button id="menuToggle" class="icon-button" title="Menu">â˜°</button>
        </div>
      </div>

      <nav class="main-nav" role="navigation" aria-label="Main">
        <button class="nav-item active" data-view="entry">Entry</button>
        <button class="nav-item" data-view="summary">Summary</button>
        <!-- <button class="nav-item" data-view="settings">Settings</button>
        <button class="nav-item" data-view="user">User</button>
        <button class="nav-item" data-view="about">About</button> -->
      </nav>

      <div id="mainMenu" class="menu-panel">
        <button data-to="user">User Info</button>
        <button data-to="settings">Settings</button>
        <button data-to="about">About</button>
        <button id="exportMenuBtn" data-to="backup">Export/Backup</button>
      </div>
    </header>

    <main class="app-body">
      <!-- ENTRY VIEW -->
      <section id="view-entry" class="view active">
        <section class="card small-card">
          <div class="daily-header">
            <div>
              <div class="daily-label">Selected date</div>
              <div id="selectedDateLabel" class="selected-date-text"></div>
            </div>
            <div class="date-input-wrap">
              <input id="date" type="date" />
            </div>
          </div>

          <div class="summary-row">
            <div>
              <div class="summary-tag">Today Expense</div>
              <div id="sumExpense" class="summary-value expense">â‚¹0</div>
            </div>
            <div>
              <div class="summary-tag">Today Income</div>
              <div id="sumIncome" class="summary-value income">â‚¹0</div>
            </div>
            <div>
              <div class="summary-tag">Net</div>
              <div id="sumNet" class="summary-value net">â‚¹0</div>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="section-title">Add entry for this day</div>
          <form id="money-form" class="form-grid">
            <div>
              <label for="type">Type</label>
              <select id="type">
                <option>Expense</option>
                <option>Income</option>
              </select>
            </div>

            <div>
              <label for="amount">Amount</label>
              <input id="amount" type="number" min="0" step="0.01" />
            </div>

            <div class="full">
              <label for="description">Description</label>
              <input id="description" type="text" placeholder="e.g., Tea, Rent, Salary" />
            </div>

            <div>
              <label for="category">Category</label>
              <input id="category" type="text" placeholder="Food, Travel..." />
              <div id="category-pills" class="pill-row"></div>
            </div>

            <div>
              <label for="payMethod">Payment</label>
              <select id="payMethod">
                <option>Cash</option>
                <option>UPI</option>
                <option>Card</option>
                <option>Bank</option>
              </select>
            </div>

            <div id="paySubTypeWrap" style="display:none;">
              <label id="paySubTypeLabel" for="paySubType">UPI app</label>
              <select id="paySubType"></select>
            </div>

            <div class="full">
              <label for="note">Note</label>
              <textarea id="note" rows="2" placeholder="Extra details..."></textarea>
            </div>

            <!-- Group split -->
            <div class="full split-block">
              <label><input id="isGroup" type="checkbox" /> Group / Split expense</label>

              <div id="splitOptions" style="display:none;">
                <label>Participants (comma separated names)</label>
                <input id="splitNames" placeholder="Alice,Bob,Charlie" />

                <div class="row">
                  <div>
                    <label>Split mode</label>
                    <select id="splitMode">
                      <option value="equal">Equal split</option>
                      <option value="custom">Custom amounts (others)</option>
                    </select>
                  </div>
                  <div id="myShareWrap">
                    <label>Your share</label>
                    <input id="myShare" type="number" min="0" step="0.01" placeholder="Your contribution" />
                  </div>
                </div>

                <div id="customSplits" style="display:none;">
                  <label>Custom amounts for participants (comma) in same order</label>
                  <input id="splitAmounts" placeholder="20,30,10" />
                </div>

                <div class="info" style="margin-top:0.5rem;">
                  When you save: your share becomes an Expense. Other participants become 'to receive' items and appear in Summary.
                </div>
              </div>
            </div>

            <div class="full form-actions">
              <button id="submitBtn" class="btn-primary" type="submit">Save entry</button>
              <button id="clear-btn" type="button" class="btn-secondary">Clear</button>
            </div>
            <div class="full"><div id="status" class="status"></div></div>
          </form>
        </section>

        <section class="card">
          <div class="section-title">Entries for this day</div>
          <div id="entriesList" class="list"></div>
        </section>
      </section>

      <!-- SUMMARY VIEW -->
      <section id="view-summary" class="view">
        <section class="card">
          <div class="section-title">Filters & totals</div>

          <div class="row">
            <div>
              <label>Period</label>
              <select id="dateMode">
                <option value="month">Month</option>
                <option value="year">Year</option>
                <option value="all">All</option>
              </select>
            </div>

            <div id="monthPickerWrap">
              <label>Month</label>
              <input id="monthPicker" type="month" />
            </div>

            <div id="yearPickerWrap" style="display:none;">
              <label>Year</label>
              <input id="yearPicker" type="number" />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Type filter</label>
              <select id="typeFilter">
                <option value="all">All</option>
                <option value="Expense">Expense</option>
                <option value="Income">Income</option>
                <option value="Split">Split requests</option>
              </select>
            </div>
            <div>
              <label>Payment</label>
              <select id="filterPayment">
                <option value="All">All</option>
                <option>Cash</option>
                <option>UPI</option>
                <option>Card</option>
                <option>Bank</option>
              </select>
            </div>
            <div>
              <label>Category</label>
              <select id="filterCategory"><option>All</option></select>
            </div>
          </div>

          <div class="row summary-row" style="margin-top:0.6rem;">
            <div><div class="summary-tag">Total Expense</div><div id="monthSumExpense" class="summary-value expense">â‚¹0</div></div>
            <div><div class="summary-tag">Total Income</div><div id="monthSumIncome" class="summary-value income">â‚¹0</div></div>
            <div><div class="summary-tag">Split outstanding</div><div id="splitOutstanding" class="summary-value">â‚¹0</div></div>
          </div>
        </section>

        <section class="card">
          <div class="section-title">Expense by category</div>
          <canvas id="categoryPie" height="220"></canvas>
          <div id="categoryLegend" class="legend"></div>
        </section>

        <section class="card">
          <div class="section-title">History (filtered)</div>
          <div id="summaryHistory" class="list"></div>
        </section>
      </section>

      <!-- SETTINGS VIEW -->
      <section id="view-settings" class="view">
        <section class="card">
          <div class="section-title">App customization & theme</div>

          <div>
            <label>Dark / Light</label>
            <select id="themeSelect">
              <option value="dark">Dark</option>
              <option value="light">Light</option>
            </select>
          </div>

          <div>
            <label>Accent color</label>
            <input id="accentColor" type="color" value="#2563eb" />
          </div>

          <div>
            <label>Default currency symbol</label>
            <input id="currencySymbol" placeholder="â‚¹" />
          </div>

          <div>
            <label>Default categories (comma separated)</label>
            <input id="settingCategories" placeholder="Food,Travel,Bills,Shopping,Salary,Other" />
          </div>

          <div style="margin-top:0.6rem;">
            <button id="saveCustomization" class="btn-primary">Save customization</button>
            <button id="resetCustomization" class="btn-secondary">Reset to defaults</button>
          </div>
        </section>

        <section class="card">
          <div class="section-title">UPI / Cards / Banks</div>
          <div class="settings-group">
            <h4>UPI apps</h4>
            <div id="settingsUpi" class="settings-list"></div>
            <div class="settings-add-row">
              <input id="newUpi" placeholder="Add UPI app" />
              <button id="addUpiBtn" class="btn-secondary">Add</button>
            </div>
          </div>

          <div class="settings-group">
            <h4>Cards</h4>
            <div id="settingsCards" class="settings-list"></div>
            <div class="settings-add-row">
              <input id="newCard" placeholder="Add card" />
              <button id="addCardBtn" class="btn-secondary">Add</button>
            </div>
          </div>

          <div class="settings-group">
            <h4>Banks</h4>
            <div id="settingsBanks" class="settings-list"></div>
            <div class="settings-add-row">
              <input id="newBank" placeholder="Add bank" />
              <button id="addBankBtn" class="btn-secondary">Add</button>
            </div>
          </div>
        </section>
      </section>

      <!-- USER VIEW -->
      <section id="view-user" class="view">
        <section class="card">
          <div class="section-title">User info & security</div>

          <div>
            <label>Your name</label>
            <input id="userNameField" />
          </div>

          <div>
            <label>Security hint (optional)</label>
            <input id="securityHint" placeholder="e.g., Mother's name" />
          </div>

          <div style="margin-top:0.5rem;">
            <label><input id="biometricEnabled" type="checkbox" /> Prefer biometric unlock (device support only)</label>
          </div>

          <div style="margin-top:0.6rem;">
            <label>Change password</label>
            <input id="oldPassword" type="password" placeholder="Current password" />
            <input id="newPassword" type="password" placeholder="New password" />
            <button id="changePasswordBtn" class="btn-primary">Update password</button>
            <div id="passwordStatus" class="modal-status"></div>
          </div>
        </section>
      </section>

      <!-- ABOUT VIEW -->
      <section id="view-about" class="view">
        <section class="card">
          <div class="section-title">About LUDARP Money Tracker</div>
          <p class="info">
            This app keeps all data locally in your browser. It is a PWA-ready offline tracker with split/group support and customizable settings.
          </p>
          <p class="info small">Version: 1.0 â€¢ Offline only â€¢ No external servers</p>
        </section>
      </section>
    </main>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
