<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Daily Money Tracker</title>

  <meta name="theme-color" content="#2563eb" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- AUTH / LOGIN SCREEN -->
  <div id="authScreen" class="auth-screen">
    <div class="auth-card">
      <h2 id="authTitle">Welcome</h2>
      <p class="subtitle" id="authSubtitle"></p>

      <form id="authForm">
        <div id="authNameRow">
          <label for="authName">Your name</label>
          <input type="text" id="authName" placeholder="Enter your name" />
        </div>

        <label for="authPassword">App password</label>
        <input type="password" id="authPassword" placeholder="Set / enter password" />

        <button type="submit" class="btn-primary" id="authSubmitBtn">Continue</button>
      </form>
    </div>
  </div>

  <!-- MAIN APP -->
  <div class="app" id="appRoot" style="display:none;">
    <!-- Top bar -->
    <header class="app-header card">
      <div>
        <h1>LUDARP Money Tracker</h1>
        <p class="subtitle">Offline, local-storage based daily expense tracker.</p>
      </div>
      <nav class="nav-tabs">
        <button class="nav-tab active" data-view="entry">Entry</button>
        <button class="nav-tab" data-view="summary">Summary</button>
      </nav>
    </header>

    <!-- ENTRY VIEW -->
    <main id="view-entry" class="view active">
      <!-- Selected date + daily summary -->
      <section class="card">
        <div class="daily-header">
          <div>
            <div class="daily-label">Selected date</div>
            <div id="selectedDateLabel" class="selected-date-text"></div>
          </div>
          <div class="date-input-wrap">
            <input type="date" id="date" />
          </div>
        </div>

        <div class="summary-row">
          <div>
            <div class="summary-tag">Today Expense</div>
            <div class="summary-value expense" id="sumExpense">₹0</div>
          </div>
          <div>
            <div class="summary-tag">Today Income</div>
            <div class="summary-value income" id="sumIncome">₹0</div>
          </div>
          <div>
            <div class="summary-tag">Net</div>
            <div class="summary-value net" id="sumNet">₹0</div>
          </div>
        </div>
      </section>

      <!-- Entry form -->
      <section class="card">
        <div class="section-title" id="formTitle">Add entry for this day</div>
        <form id="money-form">
          <label for="type">Type</label>
          <select id="type">
            <option value="Expense">Expense</option>
            <option value="Income">Income</option>
          </select>

          <label for="description">Description</label>
          <input type="text" id="description" placeholder="Food, Bus, Rent, Salary..." required />

          <label for="category">Category</label>
          <input type="text" id="category" placeholder="Food, Travel, Bills, Salary..." />
          <div class="pill-row" id="category-pills">
            <!-- Dynamic category pills will be inserted here -->
          </div>

          <div class="row">
            <div>
              <label for="payMethod">Payment</label>
              <select id="payMethod">
                <option>Cash</option>
                <option>UPI</option>
                <option>Card</option>
                <option>Bank</option>
              </select>
            </div>
            <div>
              <label for="amount">Amount</label>
              <input type="number" id="amount" min="0" step="0.01" required />
            </div>
          </div>

          <!-- Sub-type for UPI / Card / Bank -->
          <div id="paySubTypeWrap" style="display:none;">
            <label for="paySubType" id="paySubTypeLabel">UPI app</label>
            <select id="paySubType"></select>
          </div>

          <!-- Extra notes -->
          <label for="note">Note (optional)</label>
          <textarea id="note" rows="2" placeholder="Any extra details..."></textarea>

          <button type="submit" class="btn-primary" id="submitBtn">Save entry</button>
          <button type="button" class="btn-secondary" id="clear-btn">Clear form</button>

          <div class="status" id="status"></div>
        </form>
      </section>

      <!-- Entries list -->
      <section class="card">
        <div class="section-title">Entries for this day</div>
        <div id="entriesList" class="list"></div>
      </section>
    </main>

    <!-- SUMMARY VIEW -->
    <main id="view-summary" class="view">
      <!-- Summary & filters -->
      <section class="card">
        <div class="section-title">Summary & filters</div>

        <div class="row">
          <div>
            <label for="dateMode">Period</label>
            <select id="dateMode">
              <option value="month">Month</option>
              <option value="year">Year</option>
              <option value="all">All time</option>
            </select>
          </div>
          <div id="monthPickerWrap">
            <label for="monthPicker">Month</label>
            <input type="month" id="monthPicker" />
          </div>
          <div id="yearPickerWrap" style="display:none;">
            <label for="yearPicker">Year</label>
            <input type="number" id="yearPicker" />
          </div>
        </div>

        <div class="row" style="margin-top:0.5rem;">
          <div>
            <div class="summary-tag">Total Expense</div>
            <div class="summary-value expense" id="monthSumExpense">₹0</div>
          </div>
          <div>
            <div class="summary-tag">Total Income</div>
            <div class="summary-value income" id="monthSumIncome">₹0</div>
          </div>
        </div>

        <div class="row" style="margin-top:0.75rem;">
          <div>
            <label for="filterPayment">Payment mode</label>
            <select id="filterPayment">
              <option value="All">All</option>
              <option value="Cash">Cash</option>
              <option value="UPI">UPI</option>
              <option value="Card">Card</option>
              <option value="Bank">Bank</option>
            </select>
          </div>
          <div>
            <label for="filterCategory">Category</label>
            <select id="filterCategory">
              <option value="All">All</option>
            </select>
          </div>
        </div>
      </section>

      <!-- Pie chart -->
      <section class="card">
        <div class="section-title">Expense by category (Pie chart)</div>
        <canvas id="categoryPie" height="220"></canvas>
        <div id="categoryLegend" class="legend"></div>
      </section>

      <!-- History list -->
      <section class="card">
        <div class="section-title">History (filtered)</div>
        <div id="summaryHistory" class="list"></div>
      </section>

      <!-- Settings: categories & payment options -->
      <section class="card">
        <div class="section-title">Settings & customization</div>

        <div class="settings-group">
          <h4>Categories</h4>
          <div class="settings-list" id="settingsCategories"></div>
          <div class="settings-add-row">
            <input type="text" id="newCategory" placeholder="New category (eg. Fuel)" />
            <button type="button" class="btn-secondary btn-small" id="addCategoryBtn">Add</button>
          </div>
        </div>

        <div class="settings-group">
          <h4>UPI apps</h4>
          <div class="settings-list" id="settingsUpi"></div>
          <div class="settings-add-row">
            <input type="text" id="newUpi" placeholder="eg. GPay, PhonePe..." />
            <button type="button" class="btn-secondary btn-small" id="addUpiBtn">Add</button>
          </div>
        </div>

        <div class="settings-group">
          <h4>Cards</h4>
          <div class="settings-list" id="settingsCards"></div>
          <div class="settings-add-row">
            <input type="text" id="newCard" placeholder="eg. HDFC credit card" />
            <button type="button" class="btn-secondary btn-small" id="addCardBtn">Add</button>
          </div>
        </div>

        <div class="settings-group">
          <h4>Banks</h4>
          <div class="settings-list" id="settingsBanks"></div>
          <div class="settings-add-row">
            <input type="text" id="newBank" placeholder="eg. Canara, SBI..." />
            <button type="button" class="btn-secondary btn-small" id="addBankBtn">Add</button>
          </div>
        </div>
      </section>

      <!-- Backup / Restore -->
      <section class="card">
        <div class="section-title">Backup & Restore</div>
        <p class="info">
          Export your data as CSV (Excel / Google Sheets) or JSON backup.
          Export requires your app password. Import will replace current data.
        </p>
        <div class="backup-row">
          <button type="button" class="btn-secondary" id="exportCsvBtn">Export CSV</button>
          <button type="button" class="btn-secondary" id="exportJsonBtn">Export JSON</button>
        </div>
        <div class="import-row">
          <input type="file" id="importFile" accept=".csv,text/csv,application/json,.json" />
          <button type="button" class="btn-primary" id="importBtn">Import & replace</button>
        </div>
      </section>

      <!-- Info -->
      <section class="card">
        <div class="section-title">About this app</div>
        <p class="info">
          • Data is stored only in this browser (localStorage).<br />
          • Works offline and can be installed as a PWA.<br />
          • LUDARP-style blue accent with simple, clean cards.
        </p>
        <div class="chips-row">
          <span class="chip">Offline</span>
          <span class="chip">Local storage</span>
          <span class="chip">PWA-ready</span>
          <span class="chip">Category pie chart</span>
        </div>
      </section>
    </main>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
